### About this documentation
This documentation gives an overview of those files included in this repository that are needed to replicate the results of "Kranz, S. and Pütz. P.: Methods Matter: p-Hacking and Publication Bias in Causal Analysis in Economics: Comment" (including the online appendix), aimed for publication in the AER.
The analyses were conducted using R 4.0.5 and Stata/IC 16.0 (64 bit, Windows). All R and Stata scripts are stored in the folder "Scripts", provided and created datasets are located in the folder "Data", manually created latex templates are stored in the folder "Tex_templates" and results obtained by running the scripts are stored in the folder "Results". 


### Manual to replicate the results
If you use RStudio, open the R project 
`mm_replication.Rproj` first, then all R scripts loaded into this project should run as they are. Adjustments of the paths should be only necessary for the Stata do-files.
If you do not use an R project, you have to set your working directory at the beginning of each R script (`setwd(…)`) to the directory where the scripts are located.

0. Install the required packages by using "install_packages.R". \
`source("Scripts/install_packages.R")`

1. Run the function "adapt.MM.data" in "make_new_data.R"" to create the adapted version of BCH's data set: \
`source("Scripts/make_new_data.R")` \
`adapt.MM.data()`

2. Run dsr_job.R to create immediate files for dsr derounding. Takes some time to run. \
`source("Scripts/dsr_job.R")`

3. Source "deround_bch.R" and run the function "study.windows.with.bch.data" to create data for randomization tests.\
`source("Scripts/deround_bch.R")`\
`study.windows.with.bch.data()`

4. Source "join_star_wars.R" to create data for comparing distribution of z-statistics over time (needed for Figure 5 in our comment, Figure 3 in BCH).\
`source("Scripts/join_star_wars.R")`\

5. Source "ak_make_csv.R" and run the function "make.all.ak.csv()" to create data for Andrews and Kasy approach. Then source "ak_table.R" and run the function "make.ak.tables" to create the statistics for the Andrews and Kasy method which then be summarized to tables (including our Table 3), see below. \
`source("Scripts/ak_make_csv.R")`\
`make.all.ak.csv()`\
`source("Scripts/ak_table.R")`\
`make.ak.tables()`

6. Run/knit the RMD files in R to generate many of the figures, tables and statistics mentioned in the text:
* "ak_all_tables.Rmd" creates the results table for the Andrews and Kasy approach (including Table 3).
* "binom_tables.Rmd" creates the randomization tests (including Tables 1, A3 and A4).
* "excess-test-stats.Rmd creates the excess test statistics plots (including Figures 5 and A3).
* "remaining_tables_and_figures.Rmd" generates some of the remaining figures, tables and statistics generated by R, including Figures 1, 2 and Table A2.

7. The correlations and the specification tests for the Andrews and Kasy approach to generate Table A7 can be computed by sourcing "ak_cor.R", but this takes very long to run (half a day using 50 cores in parallel on our servers).\
`source("Scripts/ak_cor.R")`

8. "mc.R" contains code for the Monte-Carlo simulation (including Table A1). Takes very long to run. \
`source("Scripts/mc.R")` \
`run.mc()`

9. We used the Stata Code provided by BCH with slight amendments to generate the caliper tests ("caliper_tables.do"), including Tables 2 and A5, and to generate Figures 3, 4, 5, A1 and A2 ("BCH_figures_replicated.do"). Adjust working directories whenever the command "cd" is used.

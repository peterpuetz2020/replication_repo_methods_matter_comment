### About this documentation
This documentation gives an overview of those files included in this repository that are needed to replicate the results of the working paper "Kranz, S. and Pütz. P.: Rounding and other pitfalls in meta-studies on p-hacking and publication bias: A comment on Brodeur et al. (2020)".
The analyses were conducted using R 4.0.5 and Stata/IC 16.0 (64 bit, Windows). All R and Stata scripts are stored in the folder "Scripts", provided and created datasets are located in the folder "Data", manually created latex templates are stored in the folder "Tex_templates" and results obtained by running the scripts are stored in the folder "Results". Data and results that need quite a while to be generated by the provided scripts or are created by Stata are already available in respective folders. 
The lyx version of the working paper is available in the folder "Working Paper", all references can be seen inside the lyx version and it should be easy to create the pdf version by a lyx compiler (if available). 

### Manual to replicate the results
If you use RStudio, open the R project 
`mm_replication.Rproj` first, then all R scripts loaded into this project should run as they are. Adjustments of the paths should be only necessary for the do-files (see 6. and 7.)
If you do not use an R project, you have to set your working directory at the beginning of each R script (`setwd(…)`) to the directory where the scripts are located.

0. Install the required packages by using "install_packages.R".

1. Run the function "adapt.MM.data" in "make_new_data.R"" to create the adapted version of BCH's data set:
`source("Scripts/make_new_data.R")`
`adapt.MM.data()`

2. Run dsr_job.R to create immediate files for dsr derounding. Takes some time to run.
`source("Scripts/dsr_job.R")`

3. Source "deround_bch.R" and run the function "study.windows.with.bch.data" to create data for randomization tests.
`source("Scripts/deround_bch.R")`
`study.windows.with.bch.data()`

4. Run/knit the RMD files in R to generate many of the figures, tables and statistics mentioned in the text:
"binom_tables.Rmd" creates the randomization tests
"excess-test-stats.Rmd creates the excess test statistics plots
"remaining_tables_and_figures.Rmd" generates some of the remaining figures, tables and statistics generated by R.

5. The correlations and specification tests for the Andrews and Kasy approach to generate can be computed by sourcing "ak_cor.R", but this takes very long to run (half a day using 50 cores in parallel on our servers).
`source("Scripts/ak_cor.R")

6. "mc.R" contains code for the Monte-Carlo simulation. Takes very long to run.
`source("Scripts/mc.R")`
`run.mc()`

7. There are no R files for the caliper tests. We used the stata code provided by BCH with slight amendments ("wp_caliper_tables.do"). Adjust working directories whenever the command "cd" is used.
